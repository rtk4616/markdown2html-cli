<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>index</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/vs.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- Our Custom CSS
    <link rel="stylesheet" href="style.css"> -->
    <style>
        /*
    DEMO STYLE

@import "https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700";
*/

body {
    font-family: 'Poppins', sans-serif;
    background: #fafafa;
}

p {
    font-family: 'Poppins', sans-serif;
    font-size: 1.1em;
    font-weight: 300;
    line-height: 1.7em;
    /*color: #999;*/
}

a, a:hover, a:focus {
    color: inherit;
    text-decoration: none;
    transition: all 0.3s;
}

.navbar {
    padding: 15px 10px;
    background: #fff;
    border: none;
    border-radius: 0;
    margin-bottom: 40px;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
}

.navbar-btn {
    box-shadow: none;
    outline: none !important;
    border: none;
}

.line {
    width: 100%;
    height: 1px;
    border-bottom: 1px dashed #ddd;
    margin: 40px 0;
}

/* ---------------------------------------------------
    SIDEBAR STYLE
----------------------------------------------------- */
.wrapper {
    display: flex;
    align-items: stretch;
}

#sidebar {
    min-width: 300px;
    max-width: 300px;
    background: #7386D5;
    color: #fff;
    transition: all 0.3s;
}

#sidebar.active {
    margin-left: -300px;
}

#sidebar .sidebar-header {
    padding: 20px;
    background: #6d7fcc;
}

#sidebar ul.components {
    padding: 20px 0;
    border-bottom: 1px solid #47748b;
}

#sidebar ul p {
    color: #fff;
    padding: 10px;
}

#sidebar ul li a {
    padding: 10px;
    font-size: 1.1em;
    display: block;
}
#sidebar ul li a:hover {
    color: #7386D5;
    background: #fff;
}

#sidebar ul li.active > a, a[aria-expanded="true"] {
    color: #fff;
    background: #6d7fcc;
}


a[data-toggle="collapse"] {
    position: relative;
}

a[aria-expanded="false"]::before, a[aria-expanded="true"]::before {
    content: '\e259';
    display: block;
    position: absolute;
    right: 20px;
    font-family: 'Glyphicons Halflings';
    font-size: 0.6em;
}
a[aria-expanded="true"]::before {
    content: '\e260';
}


ul ul a {
    font-size: 0.9em !important;
    padding-left: 30px !important;
    background: #6d7fcc;
}

ul.CTAs {
    padding: 20px;
}

ul.CTAs a {
    text-align: center;
    font-size: 0.9em !important;
    display: block;
    border-radius: 5px;
    margin-bottom: 5px;
}

a.download {
    background: #fff;
    color: #7386D5;
}

a.article, a.article:hover {
    background: #6d7fcc !important;
    color: #fff !important;
}



/* ---------------------------------------------------
    CONTENT STYLE
----------------------------------------------------- */
#content {
    padding: 20px;
    min-height: 100vh;
    transition: all 0.3s;
}

/* ---------------------------------------------------
    MEDIAQUERIES
----------------------------------------------------- */
@media (max-width: 768px) {
    #sidebar {
        margin-left: -300px;
    }
    #sidebar.active {
        margin-left: 0;
    }
    #sidebarCollapse span {
        display: none;
    }
}
@media (min-width: 769px) {
    #sidebar {
        position:fixed;
		top: 0;
		bottom: 0;
		overflow-y: scroll;
    }
    #content{
		margin-left:300px;
	}
}
#back-to-top {
    position: fixed;
    bottom: 40px;
    right: 40px;
    z-index: 9999;
    width: 64px;
    height: 32px;
    text-align: center;
    line-height: 30px;
    background: #f5f5f5;
    color: #444;
    cursor: pointer;
    border: 0;
    border-radius: 2px;
    text-decoration: none;
    transition: opacity 0.2s ease-out;
    opacity: 0;
}
#back-to-top:hover {
    background: #e9ebec;
}
#back-to-top.show {
    opacity: 1;
}
#content {
    height: 2000px;
}


.scroll {
  width: 20px;
  /**height: 200px;*/
  overflow: auto;
  float: left;
  /*margin: 0 10px;*/
}

.scroll1::-webkit-scrollbar {
  width: 5px;
}
 
.scroll1::-webkit-scrollbar-track {
  background: #ddd;
}
 
.scroll1::-webkit-scrollbar-thumb {
  background: #666; 
}


footer {
    padding-top: 20px;
    padding-bottom: 20px;
    margin-top: 100px;
    color: #99979c;
    text-align: center;
    background-color: #2a2730;
}

        
        .code{padding: 2px 4px;font-size: 90%;color: #c7254e;background-color: #f9f2f4;border-radius: 4px;}
    </style>
</head>

<body>



    <div class="wrapper">
        <!-- Sidebar Holder -->
        <nav id="sidebar" class="scroll scroll1">
            <div class="sidebar-header">
                <h3>目录</h3>
            </div>
            <ul class="list-unstyled components"><li><a href="#cf8bd1bb-ea93-46fe-b76e-49fd8df2b423" data-toggle="collapse" aria-expanded="false">安装</a><ul class="collapse list-unstyled" id="cf8bd1bb-ea93-46fe-b76e-49fd8df2b423"><li><a href="#安装">安装</a></li><li><a href="#全局安装gulp">全局安装gulp</a></li><li><a href="#package-json文件-nodejs项目配置文件-">package-json文件-nodejs项目配置文件-</a></li><li><a href="#项目本地安装gulp以及gulp插件">项目本地安装gulp以及gulp插件</a></li><li><a href="#2f43a84e-1e26-426d-8b97-361062fad1c2" data-toggle="collapse" aria-expanded="false">新建gulpfile-js文件-重要-</a><ul class="collapse list-unstyled" id="2f43a84e-1e26-426d-8b97-361062fad1c2"><li><a href="#新建gulpfile-js文件-重要-">新建gulpfile-js文件-重要-</a></li><li><a href="#加载插件">加载插件</a></li><li><a href="#建立任务">建立任务</a></li><li><a href="#js代码校验-合并和压缩">js代码校验-合并和压缩</a></li><li><a href="#压缩图片">压缩图片</a></li><li><a href="#清除文件">清除文件</a></li><li><a href="#设置默认任务-default-">设置默认任务-default-</a></li><li><a href="#监听文件">监听文件</a></li></ul></li></ul></li><li><a href="#总结">总结</a></li><li><a href="#4883c081-f681-460c-b3a3-2ec652987f2f" data-toggle="collapse" aria-expanded="false">部分api说明</a><ul class="collapse list-unstyled" id="4883c081-f681-460c-b3a3-2ec652987f2f"><li><a href="#部分api说明">部分api说明</a></li><li><a href="#glob模式语法说明">glob模式语法说明</a></li><li><a href="#异步任务支持">异步任务支持</a></li></ul></li><li><a href="#javascript-source-map与gulp-sourcemaps的作用">javascript-source-map与gulp-sourcemaps的作用</a></li><li><a href="#gulp教程之gulp-uglify">gulp教程之gulp-uglify</a></li><li><a href="#gulp-autoprefixer插件说明">gulp-autoprefixer插件说明</a></li><li><a href="#gulp教程之gulp-minify-css插件说明">gulp教程之gulp-minify-css插件说明</a></li><li><a href="#gulp教程之gulp-imagemin">gulp教程之gulp-imagemin</a></li><li><a href="#gulp教程之gulp-concat合并文件">gulp教程之gulp-concat合并文件</a></li><li><a href="#gulp-ruby-sass与ruby-gem配置">gulp-ruby-sass与ruby-gem配置</a></li><li><a href="#使用示例">使用示例</a></li></ul>
        </nav>

        <!-- Page Content Holder -->
        <div id="content">
			
            <nav class="navbar navbar-default">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn">
                                <i class="glyphicon glyphicon-align-left"></i>
                                <span></span>
                            </button>
                    </div>
                </div>
            </nav>
		
            <div>
                <h1><a name="gulp前端自动化构建工具" class="anchor" href="#gulp前端自动化构建工具"><span class="header-link"></span></a>gulp前端自动化构建工具</h1><p>官网:<a href="http://gulpjs.com/">http://gulpjs.com/</a><br>github与文档:<a href="https://github.com/gulpjs/gulp/tree/master/docs">https://github.com/gulpjs/gulp/tree/master/docs</a><br>中文:<a href="http://www.gulpjs.com.cn/docs/#articles/">http://www.gulpjs.com.cn/docs/#articles/</a><br>部分插件中文说明:<a href="http://www.ydcss.com/archives/tag/gulp">http://www.ydcss.com/archives/tag/gulp</a><br>参考：<br><a href="http://markpop.github.io/2014/09/17/Gulp%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/">http://markpop.github.io/2014/09/17/Gulp%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/</a><br><a href="http://www.ydcss.com/archives/18">http://www.ydcss.com/archives/18</a><br><a href="http://blog.jobbole.com/80338/">http://blog.jobbole.com/80338/</a>   </p>
<p>npm插件搜索：<a href="https://www.npmjs.com/browse/keyword/gulpplugin">https://www.npmjs.com/browse/keyword/gulpplugin</a><br>gulp插件搜索:<a href="http://gulpjs.com/plugins/">http://gulpjs.com/plugins/</a>   </p>
<p>gulp资料大全：<a href="https://segmentfault.com/a/1190000004915222">https://segmentfault.com/a/1190000004915222</a>   </p>
<p><strong>gulp</strong>是最近流行前端构建工具，苦于之前使用Grunt，代码很难阅读，现在出了Gulp，真是摆脱了痛苦。<br><strong>为什么使用Gulp</strong><br>Gulp基于Node.js的前端构建工具，通过Gulp的插件可以<strong>实现前端代码的编译（sass、less）、压缩、测试；图片的压缩；浏览器自动刷新</strong>，还有许多强大的插件可以在<a href="http://gulpjs.com/plugins/">这里</a>查找。比起Grunt不仅配置简单而且更容易阅读和维护。   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'sass'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/styles/main.scss'</span>)   
    .pipe(sass({ <span class="hljs-attr">style</span>: <span class="hljs-string">'compressed'</span> }))   
    .pipe(autoprefixer(<span class="hljs-string">'last 2 version'</span>, <span class="hljs-string">'safari 5'</span>, <span class="hljs-string">'ie 8'</span>, <span class="hljs-string">'ie 9'</span>, <span class="hljs-string">'opera 12.1'</span>, <span class="hljs-string">'ios 6'</span>, <span class="hljs-string">'android 4'</span>))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/css'</span>))   
});</span>
</code></pre><p><strong>使用Gulp我们只需要放一个路径，通过管道方式使用插件，最后生成文件</strong>，是不是有种jQuery的感觉。现在是否对Gulp感兴趣了，那就开始使用Gulp吧！   </p>
<h2><a name="安装" class="anchor" href="#安装"><span class="header-link"></span></a>安装</h2><p>安装nodejs -&gt; 全局安装gulp -&gt; 项目安装gulp以及gulp插件 -&gt; 配置gulpfile.js -&gt; 运行任务<br>1、首先安装nodejs。略<br>3.1、说明：npm（node package manager）nodejs的包管理器，用于node插件管理（包括安装、卸载、管理依赖等）；<br>使用npm安装插件：命令提示符执行npm install <name> [-g] [--save-dev]；   </p>
<p><name>：node插件名称。例：npm install gulp-less --save-dev   </p>
<ul>
<li>-g：全局安装。将会安装在C:\Users\Administrator\AppData\Roaming\npm，<strong>并且写入系统环境变量</strong>；<strong>非全局安装：将会安装在当前定位目录；  全局安装可以通过命令行在任何地方调用它，本地安装将安装在定位目录的node_modules文件夹下，通过nodejs的require()调用；</strong>   </li>
<li>--save：将保存配置信息至<code>package.json</code>（<strong>package.json是nodejs项目配置文件</strong>）；   </li>
<li>-dev：保存至package.json的devDependencies节点，不指定-dev将保存至dependencies节点；<br><strong>为什么要保存至package.json？</strong><br>因为node插件包相对来说非常庞大，所以加入版本管理，将配置信息写入package.json并将其加入版本管理，其他开发者对应下载即可<br>（命令提示符<strong>执行npm install，则会根据package.json下载所有需要的包</strong>）。   </li>
</ul>
<p>使用npm卸载插件：npm uninstall <name> [-g] [--save-dev]  PS：不要直接删除本地插件包<br>使用npm更新插件：npm update <name> [-g] [--save-dev]<br>查看npm帮助：npm help<br>当前目录已安装插件：npm list<br>npm安装插件过程：从<a href="http://registry.npmjs.org下载对应的插件包（该网站服务器位于国外，所以经常下载缓慢或出现异常），解决办法往下看↓↓↓↓↓↓。">http://registry.npmjs.org下载对应的插件包（该网站服务器位于国外，所以经常下载缓慢或出现异常），解决办法往下看↓↓↓↓↓↓。</a>   </p>
<p><strong>npm使用国内镜像</strong><br>国内镜像官方网址：<a href="http://npm.taobao.org；">http://npm.taobao.org；</a><br>使用方式有四种：<br>1、安装官方封装的cnpm：(不推荐)<br>安装：命令提示符执行npm install cnpm -g --registry=<a href="https://registry.npm.taobao.org；或者直接使用镜像">https://registry.npm.taobao.org；或者直接使用镜像</a><br>注意：安装完后最好查看其版本号cnpm -v或关闭命令提示符重写打开，安装完直接使用有可能会出现错误；<br>注：cnpm跟npm用法完全一致，只是在执行命令时将npm改为cnpm（以下操作将以cnpm代替npm）。   </p>
<p>2、通过config命令   </p>
<pre><code>

<span class="coffeescript"><span class="hljs-built_in">npm</span> config set registry https:<span class="hljs-regexp">//</span>registry.<span class="hljs-built_in">npm</span>.taobao.org</span>
</code></pre><p>3、命令行指定   </p>
<pre><code>

<span class="coffeescript"><span class="hljs-built_in">npm</span> --registry https:<span class="hljs-regexp">//</span>registry.<span class="hljs-built_in">npm</span>.taobao.org</span>
</code></pre><p>4、编辑 ~/.npmrc 加入下面内容<br>registry = <a href="https://registry.npm.taobao.org">https://registry.npm.taobao.org</a>   </p>
<h3><a name="全局安装gulp" class="anchor" href="#全局安装gulp"><span class="header-link"></span></a>全局安装gulp</h3><p>安装：命令提示符执行npm install gulp -g；<br>查看是否正确安装：命令提示符执行gulp -v，出现版本号即为正确安装。<br>安装之后的位置:<br>C:\Users\xby\AppData\Roaming\npm\gulp -&gt; C:\Users\xby\AppData\Roaming\npm\node_modules\gulp\bin\gulp.js   </p>
<h3><a name="package-json文件-nodejs项目配置文件-" class="anchor" href="#package-json文件-nodejs项目配置文件-"><span class="header-link"></span></a>package.json文件(nodejs项目配置文件)</h3><p>说明：package.json是基于nodejs项目必不可少的配置文件，它是存放在项目根目录的普通json文件；<br>它是这样一个json文件（注意：json文件内是不能写注释的，复制下列内容请删除注释）：当然我们可以手动新建这个配置文件，<br>但是我们应该使用更为效率的方法：命令提示符执行<code>npm init</code>   </p>
<pre><code>

<span class="cpp">{   
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,   <span class="hljs-comment">//项目名称（必须）   </span>
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,   <span class="hljs-comment">//项目版本（必须）   </span>
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"This is for study gulp project !"</span>,   <span class="hljs-comment">//项目描述（必须）   </span>
  <span class="hljs-string">"homepage"</span>: <span class="hljs-string">""</span>,   <span class="hljs-comment">//项目主页   </span>
  <span class="hljs-string">"repository"</span>: {    <span class="hljs-comment">//项目资源库   </span>
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"git"</span>,   
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://git.oschina.net/xxxx"</span>   
  },   
  <span class="hljs-string">"author"</span>: {    <span class="hljs-comment">//项目作者信息   </span>
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"surging"</span>,   
    <span class="hljs-string">"email"</span>: <span class="hljs-string">"surging2@qq.com"</span>   
  },   
  <span class="hljs-string">"license"</span>: <span class="hljs-string">"ISC"</span>,    <span class="hljs-comment">//项目许可协议   </span>
  <span class="hljs-string">"devDependencies"</span>: {    <span class="hljs-comment">//项目依赖的插件   </span>
    <span class="hljs-string">"gulp"</span>: <span class="hljs-string">"^3.8.11"</span>,   
    <span class="hljs-string">"gulp-less"</span>: <span class="hljs-string">"^3.0.0"</span>   
  }   
}</span>
</code></pre><p><img src="/data/dokuwiki/web/pasted/20160412-122606.png" alt=""><br>查看package.json帮助文档，命令提示符执行<code>npm help package.json</code><br>特别注意：package.json是一个普通json文件，所以不能添加任何注释。参看 <a href="http://www.zhihu.com/question/23004511">http://www.zhihu.com/question/23004511</a>   </p>
<h3><a name="项目本地安装gulp以及gulp插件" class="anchor" href="#项目本地安装gulp以及gulp插件"><span class="header-link"></span></a>项目本地安装gulp以及gulp插件</h3><p>安装：定位目录命令后提示符执行   </p>
<pre><code>

<span class="sql">npm <span class="hljs-keyword">install</span> &lt;<span class="hljs-keyword">name</span>&gt;  <span class="hljs-comment">--save-dev；   </span>

<span class="hljs-number">1</span>、首先得本地安装gulp：   
cnpm <span class="hljs-keyword">install</span> gulp <span class="hljs-comment">--save-dev；   </span>
<span class="hljs-number">2</span>、然后再安装gulp插件：   
npm <span class="hljs-keyword">install</span> gulp-<span class="hljs-keyword">less</span> <span class="hljs-comment">--save-dev</span></span>
</code></pre><p>将会安装在<code>node_modules</code>的gulp-less目录下，该目录下有一个gulp-less的使用帮助文档README.md；<br>PS：细心的你可能会发现，我们全局安装了gulp，项目也安装了gulp，<strong>全局安装gulp是为了执行gulp任务，本地安装gulp则是为了调用gulp插件的功能。</strong>   </p>
<p><strong>常用插件</strong>   </p>
<ul>
<li>sass的编译（gulp-ruby-sass）   </li>
<li>自动添加css前缀（gulp-autoprefixer）   </li>
<li>压缩css（gulp-minify-css）   </li>
<li>gulp-make-css-url-version  给css文件里面的url添加版本号   </li>
<li>gulp-sourcemaps就是让gulp支持js sourcemap的能力   </li>
<li>js代码校验（gulp-jshint）   </li>
<li>合并js文件（gulp-concat）   </li>
<li>压缩js代码（gulp-uglify）   </li>
<li>压缩图片（gulp-imagemin）   </li>
<li>自动刷新页面（gulp-livereload）   </li>
<li>图片缓存，只有图片替换了才压缩（gulp-cache）   </li>
<li>更改提醒（gulp-notify）   </li>
<li>清除文件（del）<br>安装这些插件需要运行如下命令：  </li>
</ul>
<pre><code>

<span class="sql">$ npm <span class="hljs-keyword">install</span> gulp gulp-ruby-sass gulp-make-css-<span class="hljs-keyword">url</span>-<span class="hljs-keyword">version</span> gulp-autoprefixer gulp-sourcemaps gulp-minify-css gulp-jshint gulp-<span class="hljs-keyword">concat</span> gulp-uglify gulp-imagemin gulp-notify gulp-<span class="hljs-keyword">rename</span> gulp-livereload gulp-<span class="hljs-keyword">cache</span> del <span class="hljs-comment">--save-dev</span></span>
</code></pre><h3><a name="新建gulpfile-js文件-重要-" class="anchor" href="#新建gulpfile-js文件-重要-"><span class="header-link"></span></a>新建gulpfile.js文件（重要）</h3><p>说明：<strong>gulpfile.js是gulp项目的配置文件</strong>，是位于项目根目录的普通js文件（其实将gulpfile.js放入其他文件夹下亦可）。<br>它大概是这样一个js文件（更多插件配置请查看<a href="http://www.ydcss.com/archives/tag/gulp">这里</a>）：   </p>
<pre><code>

<span class="javascript"><span class="hljs-comment">//导入工具包 require('node_modules里对应模块')   </span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>), <span class="hljs-comment">//本地安装gulp所用到的地方   </span>
    less = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-less'</span>);   

<span class="hljs-comment">//定义一个testLess任务（自定义任务名称）   </span>
gulp.task(<span class="hljs-string">'testLess'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/less/index.less'</span>) <span class="hljs-comment">//该任务针对的文件   </span>
        .pipe(less()) <span class="hljs-comment">//该任务调用的模块   </span>
        .pipe(gulp.dest(<span class="hljs-string">'src/css'</span>)); <span class="hljs-comment">//将会在src/css下生成index.css   </span>
});   

gulp.task(<span class="hljs-string">'default'</span>,[<span class="hljs-string">'testLess'</span>, <span class="hljs-string">'elseTask'</span>]); <span class="hljs-comment">//定义默认任务   </span>

<span class="hljs-comment">//gulp.task(name[, deps], fn) 定义任务  name：任务名称 deps：依赖任务名称 fn：回调函数   </span>
<span class="hljs-comment">//gulp.src(globs[, options]) 执行任务处理的文件  globs：处理的文件路径(字符串或者字符串数组)    </span>
<span class="hljs-comment">//gulp.dest(path[, options]) 处理完后文件生成路径</span></span>
</code></pre><h4><a name="加载插件" class="anchor" href="#加载插件"><span class="header-link"></span></a>加载插件</h4><p>接着我们要创建一个gulpfile.js在根目录下，然后在里面加载插件：   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-ruby-sass'</span>),   
    autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-autoprefixer'</span>),   
    minifycss = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-minify-css'</span>),   
    jshint = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-jshint'</span>),   
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>),   
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-imagemin'</span>),   
    rename = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-rename'</span>),   
    concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-concat'</span>),   
    notify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-notify'</span>),   
    cache = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-cache'</span>),   
    livereload = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-livereload'</span>),   
    del = <span class="hljs-built_in">require</span>(<span class="hljs-string">'del'</span>),   
    sourcemaps=<span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-sourcemaps'</span>);</span>
</code></pre><h4><a name="建立任务" class="anchor" href="#建立任务"><span class="header-link"></span></a>建立任务</h4><p>编译sass、自动添加css前缀和压缩<br>首先我们编译sass，添加前缀，保存到我们指定的目录下面，还没结束，我们还要压缩，给文件添加.min后缀再输出压缩文件到指定目录，最后提醒任务完成了：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'styles'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/styles/main.scss'</span>)   
    .pipe(sass({ <span class="hljs-attr">style</span>: <span class="hljs-string">'expanded'</span> }))   
    .pipe(autoprefixer(<span class="hljs-string">'last 2 version'</span>, <span class="hljs-string">'safari 5'</span>, <span class="hljs-string">'ie 8'</span>, <span class="hljs-string">'ie 9'</span>, <span class="hljs-string">'opera 12.1'</span>, <span class="hljs-string">'ios 6'</span>, <span class="hljs-string">'android 4'</span>))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/css'</span>))   
    .pipe(rename({<span class="hljs-attr">suffix</span>: <span class="hljs-string">'.min'</span>}))   
    .pipe(minifycss())   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/css'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Styles task complete'</span> }));   
});</span>
</code></pre><p>让我解释一下：<br>gulp.task(&#39;styles&#39;, function () {...});<br>gulp.task这个API用来创建任务，在命令行下可以输入$ gulp styles来执行上面的任务。<br>return gulp.src(&#39;src/styles/main.scss&#39;)<br>gulp.src这个API设置需要处理的文件的路径，可以是多个文件以数组的形式[main.scss, vender.scss]，也可以是正则表达式/<em> </em>/*.scss。<br>.pipe(sass({ style: &#39;expanded&#39; }))<br>我们使用.pipe()这个API将需要处理的文件导向sass插件，那些插件的用法可以在github上找到，为了方便大家查找我已经在上面列出来了。<br>.pipe(gulp.dest(&#39;dist/assets/css&#39;));<br>gulp.dest()API设置生成文件的路径，一个任务可以有多个生成路径，一个可以输出未压缩的版本，另一个可以输出压缩后的版本。<br>为了更好的了解Gulp API，强烈建议看一下Gulp API文档，其实Gulp API就这么几个，没什么好可怕的。   </p>
<h4><a name="js代码校验-合并和压缩" class="anchor" href="#js代码校验-合并和压缩"><span class="header-link"></span></a>js代码校验、合并和压缩</h4><p>希望大家已经知道如何去创建一个任务了，接下来我们完成scripts的校验、合并和压缩的任务吧：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'scripts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/scripts/**/*.js'</span>)   
    .pipe(jshint(<span class="hljs-string">'.jshintrc'</span>))   
    .pipe(jshint.reporter(<span class="hljs-string">'default'</span>))   
    .pipe(concat(<span class="hljs-string">'main.js'</span>))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/js'</span>))   
    .pipe(rename({<span class="hljs-attr">suffix</span>: <span class="hljs-string">'.min'</span>}))   
    .pipe(uglify())   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/js'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Scripts task complete'</span> }));   
});</span>
</code></pre><p>需要提醒的是我们要设置JSHint的reporter方式，上面使用的是default默认的，了解更多点击这里。   </p>
<h4><a name="压缩图片" class="anchor" href="#压缩图片"><span class="header-link"></span></a>压缩图片</h4><pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'images'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/images/**/*'</span>)   
    .pipe(imagemin({ <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> }))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/assets/img'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Images task complete'</span> }));   
});</span>
</code></pre><p>这个任务使用imagemin插件把所有在src/images/目录以及其子目录下的所有图片（文件）进行压缩，我们可以进一步优化，利用缓存保存已经压缩过的图片，使用之前装过的gulp-cache插件，不过要修改一下上面的代码：<br>将这行代码:<br>.pipe(imagemin({ optimizationLevel: 3, progressive: true, interlaced: true }))<br>修改成:<br>.pipe(cache(imagemin({ optimizationLevel: 5, progressive: true, interlaced: true })))<br>现在，只有新建或者修改过的图片才会被压缩了。   </p>
<h4><a name="清除文件" class="anchor" href="#清除文件"><span class="header-link"></span></a>清除文件</h4><p>在任务执行前，最好先清除之前生成的文件：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'clean'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{   
    del([<span class="hljs-string">'dist/assets/css'</span>, <span class="hljs-string">'dist/assets/js'</span>, <span class="hljs-string">'dist/assets/img'</span>], cb)   
});</span>
</code></pre><p>在这里没有必要使用Gulp插件了，可以使用NPM提供的插件。我们用一个回调函数（cb）确保在退出前完成任务。   </p>
<h4><a name="设置默认任务-default-" class="anchor" href="#设置默认任务-default-"><span class="header-link"></span></a>设置默认任务（default）</h4><p>我们在命令行下输入$ gulp执行的就是默认任务，现在我们为默认任务指定执行上面写好的三个任务：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'default'</span>, [<span class="hljs-string">'clean'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
    gulp.start(<span class="hljs-string">'styles'</span>, <span class="hljs-string">'scripts'</span>, <span class="hljs-string">'images'</span>);   
});</span>
</code></pre><p>在这个例子里面，clean任务执行完成了才会去运行其他的任务，<strong>在gulp.start()里的任务执行的顺序是不确定的，所以将要在它们之前执行的任务写在数组里面。</strong>   </p>
<h4><a name="监听文件" class="anchor" href="#监听文件"><span class="header-link"></span></a>监听文件</h4><p><strong>为了监听文件的是否修改以便执行相应的任务</strong>，我们需要创建一个新的任务，然后利用gulp.watchAPI实现：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'watch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-comment">// Watch .scss files   </span>
  gulp.watch(<span class="hljs-string">'src/styles/**/*.scss'</span>, [<span class="hljs-string">'styles'</span>]);   
  <span class="hljs-comment">// Watch .js files   </span>
  gulp.watch(<span class="hljs-string">'src/scripts/**/*.js'</span>, [<span class="hljs-string">'scripts'</span>]);   
  <span class="hljs-comment">// Watch image files   </span>
  gulp.watch(<span class="hljs-string">'src/images/**/*'</span>, [<span class="hljs-string">'images'</span>]);   
});</span>
</code></pre><p>我们将不同类型的文件分开处理，执行对应的数组里的任务。现在我们可以在命令行输入<code>$ gulp watch</code>执行监听任务，当.sass、.js和图片修改时将执行对应的任务。   </p>
<p><strong>自动刷新页面</strong><br>Gulp也可以实现当文件修改时自动刷新页面，我们要修改watch任务，配置LiveReload：   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'watch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-comment">// Create LiveReload server   </span>
  livereload.listen();   
  <span class="hljs-comment">// Watch any files in dist/, reload on change   </span>
  gulp.watch([<span class="hljs-string">'dist/**'</span>]).on(<span class="hljs-string">'change'</span>, livereload.changed);   
});</span>
</code></pre><p>要使这个能够工作，还需要在浏览器上安装LiveReload插件，除此之外还能这样做   </p>
<p><strong> 所有任务放一起</strong>   </p>
<pre><code>

<span class="javascript"><span class="hljs-comment">/*!   
 * gulp   
 * $ npm install gulp-ruby-sass gulp-autoprefixer gulp-minify-css gulp-jshint gulp-concat gulp-uglify gulp-imagemin gulp-notify gulp-rename gulp-livereload gulp-cache del --save-dev   
 */</span>   
<span class="hljs-comment">// Load plugins   </span>
<span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-ruby-sass'</span>),   
    autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-autoprefixer'</span>),   
    minifycss = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-minify-css'</span>),   
    jshint = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-jshint'</span>),   
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>),   
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-imagemin'</span>),   
    rename = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-rename'</span>),   
    concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-concat'</span>),   
    notify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-notify'</span>),   
    cache = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-cache'</span>),   
    livereload = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-livereload'</span>),   
    del = <span class="hljs-built_in">require</span>(<span class="hljs-string">'del'</span>);   
<span class="hljs-comment">// Styles   </span>
gulp.task(<span class="hljs-string">'styles'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/styles/main.scss'</span>)   
    .pipe(sass({ <span class="hljs-attr">style</span>: <span class="hljs-string">'expanded'</span>, }))   
    .pipe(autoprefixer(<span class="hljs-string">'last 2 version'</span>, <span class="hljs-string">'safari 5'</span>, <span class="hljs-string">'ie 8'</span>, <span class="hljs-string">'ie 9'</span>, <span class="hljs-string">'opera 12.1'</span>, <span class="hljs-string">'ios 6'</span>, <span class="hljs-string">'android 4'</span>))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/styles'</span>))   
    .pipe(rename({ <span class="hljs-attr">suffix</span>: <span class="hljs-string">'.min'</span> }))   
    .pipe(minifycss())   
    .pipe(gulp.dest(<span class="hljs-string">'dist/styles'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Styles task complete'</span> }));   
});   
<span class="hljs-comment">// Scripts   </span>
gulp.task(<span class="hljs-string">'scripts'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/scripts/**/*.js'</span>)   
    .pipe(jshint(<span class="hljs-string">'.jshintrc'</span>))   
    .pipe(jshint.reporter(<span class="hljs-string">'default'</span>))   
    .pipe(concat(<span class="hljs-string">'main.js'</span>))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/scripts'</span>))   
    .pipe(rename({ <span class="hljs-attr">suffix</span>: <span class="hljs-string">'.min'</span> }))   
    .pipe(uglify())   
    .pipe(gulp.dest(<span class="hljs-string">'dist/scripts'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Scripts task complete'</span> }));   
});   
<span class="hljs-comment">// Images   </span>
gulp.task(<span class="hljs-string">'images'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/images/**/*'</span>)   
    .pipe(cache(imagemin({ <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> })))   
    .pipe(gulp.dest(<span class="hljs-string">'dist/images'</span>))   
    .pipe(notify({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Images task complete'</span> }));   
});   
<span class="hljs-comment">// Clean   </span>
gulp.task(<span class="hljs-string">'clean'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{   
    del([<span class="hljs-string">'dist/assets/css'</span>, <span class="hljs-string">'dist/assets/js'</span>, <span class="hljs-string">'dist/assets/img'</span>], cb)   
});   
<span class="hljs-comment">// Default task   </span>
gulp.task(<span class="hljs-string">'default'</span>, [<span class="hljs-string">'clean'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
    gulp.start(<span class="hljs-string">'styles'</span>, <span class="hljs-string">'scripts'</span>, <span class="hljs-string">'images'</span>);   
});   
<span class="hljs-comment">// Watch   </span>
gulp.task(<span class="hljs-string">'watch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-comment">// Watch .scss files   </span>
  gulp.watch(<span class="hljs-string">'src/styles/**/*.scss'</span>, [<span class="hljs-string">'styles'</span>]);   
  <span class="hljs-comment">// Watch .js files   </span>
  gulp.watch(<span class="hljs-string">'src/scripts/**/*.js'</span>, [<span class="hljs-string">'scripts'</span>]);   
  <span class="hljs-comment">// Watch image files   </span>
  gulp.watch(<span class="hljs-string">'src/images/**/*'</span>, [<span class="hljs-string">'images'</span>]);   
  <span class="hljs-comment">// Create LiveReload server   </span>
  livereload.listen();   
  <span class="hljs-comment">// Watch any files in dist/, reload on change   </span>
  gulp.watch([<span class="hljs-string">'dist/**'</span>]).on(<span class="hljs-string">'change'</span>, livereload.changed);   
});</span>
</code></pre><p>在<a href="https://gist.github.com/markgoodyear/8497946#file-gruntfile-js">gist</a>上有源码，并且附上Grunt的实现作为对比。<br><strong>运行gulp task</strong><br>说明：命令提示符执行gulp 任务名称；<br>编译less：命令提示符执行gulp testLess；<br>当执行gulp default或gulp将会调用default任务里的所有任务[‘testLess’,’elseTask’]。   </p>
<h2><a name="总结" class="anchor" href="#总结"><span class="header-link"></span></a>总结</h2><ul>
<li>安装nodejs；   </li>
<li>新建package.json文件；   </li>
<li>全局和本地安装gulp；   </li>
<li>安装gulp插件；   </li>
<li>新建gulpfile.js文件；   </li>
<li>通过命令提示符运行gulp任务。   </li>
</ul>
<h2><a name="部分api说明" class="anchor" href="#部分api说明"><span class="header-link"></span></a>部分API说明</h2><p><a href="http://www.gulpjs.com.cn/docs/api/">http://www.gulpjs.com.cn/docs/api/</a><br>1、gulp.src(globs[, options])<br>参数:匹配模式（glob）或者匹配模式的数组（array of globs）<br>glob 请参考 <a href="https://github.com/isaacs/node-glob">node-glob</a> 语法 或者，你也可以直接写文件的路径。<br>options配置选项中的一个有用配置base   </p>
<pre><code>

<span class="coffeescript">gulp.src(<span class="hljs-string">'client/js/**/*.js'</span>) <span class="hljs-regexp">//</span> 匹配 <span class="hljs-string">'client/js/somedir/somefile.js'</span> 并且将 `<span class="javascript">base</span>` 解析为 `<span class="javascript">client/js/</span>`   
  .pipe(minify())   
  .pipe(gulp.dest(<span class="hljs-string">'build'</span>));  <span class="hljs-regexp">//</span> 写入 <span class="hljs-string">'build/somedir/somefile.js'</span>   

gulp.src(<span class="hljs-string">'client/js/**/*.js'</span>, { base: <span class="hljs-string">'client'</span> })   
  .pipe(minify())   
  .pipe(gulp.dest(<span class="hljs-string">'build'</span>));  <span class="hljs-regexp">//</span> 写入 <span class="hljs-string">'build/js/somedir/somefile.js'</span></span>
</code></pre><h3><a name="glob模式语法说明" class="anchor" href="#glob模式语法说明"><span class="header-link"></span></a>glob模式语法说明</h3><p>基本语法介绍   </p>
<ul>
<li><ul>
<li>匹配任意数量的字符，但不匹配/   </li>
</ul>
</li>
<li>? 匹配单个字符，但不匹配/   </li>
<li><ul>
<li><ul>
<li>匹配任意数量的字符，包括/，只要它是路径中唯一的一部分（<em> </em>匹配的内容为路径的父目录或者为空时才会生效。）   </li>
</ul>
</li>
</ul>
</li>
<li>{} 允许使用一个逗号分割的列表或者表达式   </li>
<li>! 在模式的开头用于否定一个匹配模式(即排除与模式匹配的信息)<br>ps：这里只是列了js版本的glob模式的一些常用语法。<br>2、gulp.dest(path[, options])<br>能被 pipe 进来，并且将会写文件。并且重新输出（emits）所有数据，因此<strong>你可以将它 pipe 到多个文件夹。如果某文件夹不存在，将会自动创建它。</strong>   </li>
</ul>
<pre><code>

<span class="bash">gulp.src(<span class="hljs-string">'./client/templates/*.jade'</span>)   
  .pipe(jade())   
  .pipe(gulp.dest(<span class="hljs-string">'./build/templates'</span>))   
  .pipe(minify())   
  .pipe(gulp.dest(<span class="hljs-string">'./build/minified_templates'</span>));</span>
</code></pre><p><strong>文件被写入的路径是以所给的相对路径根据所给的目标目录计算而来。类似的，相对路径也可以根据所给的 base 来计算。</strong> 请查看上述的 gulp.src 来了解更多信息。   </p>
<p>3、gulp.task(name[, deps], fn)<br>定义一个使用 Orchestrator 实现的任务（task）。   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'somename'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-comment">// 做一些事   </span>
});</span>
</code></pre><p>name任务的名字，如果你需要在命令行中运行你的某些任务，那么，请不要在名字中使用空格。<br>deps类型： Array，<strong>一个包含任务列表的数组，这些任务会在你当前任务运行之前完成。</strong>   </p>
<h3><a name="异步任务支持" class="anchor" href="#异步任务支持"><span class="header-link"></span></a>异步任务支持</h3><p>任务可以异步执行，如果 fn 能做到以下其中一点：<br>方式一、接受一个 callback参数<br>接受一个 callback，这样就能类似promise的方式确保异步任务完成之后执行某些操作。   </p>
<pre><code>

<span class="javascript"><span class="hljs-comment">// 在 shell 中执行一个命令   </span>
<span class="hljs-keyword">var</span> exec = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>).exec;   
gulp.task(<span class="hljs-string">'jekyll'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{<span class="hljs-comment">//参数cb为callback，会被gulp自动传入进去。   </span>
  <span class="hljs-comment">// 编译 Jekyll   </span>
  exec(<span class="hljs-string">'jekyll build'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{   
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> cb(err); <span class="hljs-comment">// 返回 error   </span>
    cb(); <span class="hljs-comment">// 完成 task   </span>
  });   
});</span>
</code></pre><p>方式二、返回一个 stream   </p>
<pre><code>

<span class="javascript">gulp.task(<span class="hljs-string">'somename'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">var</span> stream = gulp.src(<span class="hljs-string">'client/**/*.js'</span>)   
    .pipe(minify())   
    .pipe(gulp.dest(<span class="hljs-string">'build'</span>));   
  <span class="hljs-keyword">return</span> stream;   
});</span>
</code></pre><p>方式三、返回一个 promise   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> Q = <span class="hljs-built_in">require</span>(<span class="hljs-string">'q'</span>);   
gulp.task(<span class="hljs-string">'somename'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">var</span> deferred = Q.defer();   
  <span class="hljs-comment">// 执行异步的操作   </span>
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
    deferred.resolve();   
  }, <span class="hljs-number">1</span>);   

  <span class="hljs-keyword">return</span> deferred.promise;   
});</span>
</code></pre><p><strong>示例</strong>   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>);   

<span class="hljs-comment">// 返回一个 callback，因此系统可以知道它什么时候完成   </span>
gulp.task(<span class="hljs-string">'one'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">cb</span>) </span>{   
    <span class="hljs-comment">// 做一些事 -- 异步的或者其他的   </span>
    cb(err); <span class="hljs-comment">// 如果 err 不是 null 或 undefined，则会停止执行，且注意，这样代表执行失败了   </span>
});   

<span class="hljs-comment">// 定义一个所依赖的 task 必须在这个 task 执行之前完成   </span>
gulp.task(<span class="hljs-string">'two'</span>, [<span class="hljs-string">'one'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
    <span class="hljs-comment">// 'one' 完成后   </span>
});   

gulp.task(<span class="hljs-string">'default'</span>, [<span class="hljs-string">'one'</span>, <span class="hljs-string">'two'</span>]);</span>
</code></pre><p>4、gulp.watch(glob [, opts], tasks) 或 gulp.watch(glob [, opts, cb])<br>监视文件，并且可以在文件发生改动时候做一些事情。它总会返回一个 EventEmitter 来发射（emit）<code>change 事件。</code>   </p>
<pre><code>

<span class="cs"><span class="hljs-keyword">var</span> watcher = gulp.watch(<span class="hljs-string">'js/**/*.js'</span>, [<span class="hljs-string">'uglify'</span>,<span class="hljs-string">'reload'</span>]);   
watcher.<span class="hljs-keyword">on</span>(<span class="hljs-string">'change'</span>, function(<span class="hljs-keyword">event</span>) {   
  console.log(<span class="hljs-string">'File '</span> + <span class="hljs-keyword">event</span>.path + <span class="hljs-string">' was '</span> + <span class="hljs-keyword">event</span>.type + <span class="hljs-string">', running tasks...'</span>);   
});</span>
</code></pre><pre><code>

<span class="javascript">gulp.watch(<span class="hljs-string">'js/**/*.js'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{   
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'File '</span> + event.path + <span class="hljs-string">' was '</span> + event.type + <span class="hljs-string">', running tasks...'</span>);   
});</span>
</code></pre><p>callback 会被传入一个名为 event 的对象。这个对象描述了所监控到的变动：<br>event.type类型： String。发生的变动的类型：added, changed 或者 deleted。<br>event.path类型： String。触发了该事件的文件的路径。   </p>
<h2><a name="javascript-source-map与gulp-sourcemaps的作用" class="anchor" href="#javascript-source-map与gulp-sourcemaps的作用"><span class="header-link"></span></a>JavaScript Source Map与gulp-sourcemaps的作用</h2><p><a href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html">http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html</a><br>JavaScript脚本正变得越来越复杂。大部分源码（尤其是各种函数库和框架）都要经过转换，才能投入生产环境。<br>常见的源码转换，主要是以下三种情况：<br>　　（1）压缩，减小体积。比如jQuery 1.9的源码，压缩前是252KB，压缩后是32KB。<br>　　（2）多个文件合并，减少HTTP请求数。<br>　　（3）其他语言编译成JavaScript。最常见的例子就是CoffeeScript。<br>这三种情况，都使得实际运行的代码不同于开发代码，除错（debug）变得困难重重。<br>通常，JavaScript的解释器会告诉你，第几行第几列代码出错。但是，这对于转换后的代码毫无用处。举例来说，jQuery 1.9压缩后只有3行，每行3万个字符，所有内部变量都改了名字。你看着报错信息，感到毫无头绪，根本不知道它所对应的原始位置。<br><strong>这就是Source map想要解决的问题。</strong><br>二、什么是Source map<br>简单说，<strong>Source map就是一个信息文件，里面储存着位置信息。也就是说，转换后的代码的每一个位置，所对应的转换前的位置。</strong><br><strong>有了它，出错的时候，除错工具将直接显示原始代码，而不是转换后的代码。</strong>这无疑给开发者带来了很大方便。<br>目前，暂时只有Chrome浏览器支持这个功能。在Developer Tools的Setting设置中，确认选中&quot;Enable source maps&quot;。<br><img src="/data/dokuwiki/web/pasted/20160412-133105.png" alt=""><br>三、如何启用Source map<br>只要在转换后的代码尾部，加上一行就可以了。   </p>
<pre><code>

<span class="ruby">/<span class="hljs-regexp">/@ sourceMappingURL=/path</span><span class="hljs-regexp">/to/file</span>.js.map</span>
</code></pre><p>map文件可以放在网络上，也可以放在本地文件系统。   </p>
<p>gulp-sourcemaps就是让gulp支持这种能力，目前支持gulp-sourcemaps的gulp插件列表有<a href="https://github.com/floridoo/gulp-sourcemaps/wiki/Plugins-with-gulp-sourcemaps-support">https://github.com/floridoo/gulp-sourcemaps/wiki/Plugins-with-gulp-sourcemaps-support</a><br>使用教程:<a href="https://www.npmjs.com/package/gulp-sourcemaps">https://www.npmjs.com/package/gulp-sourcemaps</a><br>gulp-sourcemaps使用:   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>);   
<span class="hljs-keyword">var</span> concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-concat'</span>);   
<span class="hljs-keyword">var</span> sourcemaps = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-sourcemaps'</span>);   

gulp.task(<span class="hljs-string">'javascript'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{   
  <span class="hljs-keyword">return</span> gulp.src(<span class="hljs-string">'src/**/*.js'</span>)   
    .pipe(sourcemaps.init())   
      .pipe(concat(<span class="hljs-string">'all.js'</span>))   
    .pipe(sourcemaps.write())   
    .pipe(gulp.dest(<span class="hljs-string">'dist'</span>));   
});</span>
</code></pre><h2><a name="gulp教程之gulp-uglify" class="anchor" href="#gulp教程之gulp-uglify"><span class="header-link"></span></a>gulp教程之gulp-uglify</h2><p><a href="https://github.com/terinjokes/gulp-uglify#user-content-options">https://github.com/terinjokes/gulp-uglify#user-content-options</a><br>使用gulp-uglify压缩javascript文件，减小文件大小。<br>基本使用   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>);   

gulp.task(<span class="hljs-string">'jsmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/js/index.js'</span>)   
        .pipe(uglify())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><p>压缩多个js文件   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>);   

gulp.task(<span class="hljs-string">'jsmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src([<span class="hljs-string">'src/js/index.js'</span>,<span class="hljs-string">'src/js/detail.js'</span>]) <span class="hljs-comment">//多个文件以数组形式传入   </span>
        .pipe(uglify())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><p>匹配符“!”，“<em>”，“</em> *”，“{}”   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    uglify= <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>);   

gulp.task(<span class="hljs-string">'jsmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    <span class="hljs-comment">//压缩src/js目录下的所有js文件   </span>
    <span class="hljs-comment">//除了test1.js和test2.js（**匹配src/js的0个或多个子文件夹）   </span>
    gulp.src([<span class="hljs-string">'src/js/*.js'</span>, <span class="hljs-string">'!src/js/**/{test1,test2}.js'</span>])    
        .pipe(uglify())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><p>指定变量名不混淆改变   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    uglify= <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>);   

gulp.task(<span class="hljs-string">'jsmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src([<span class="hljs-string">'src/js/*.js'</span>, <span class="hljs-string">'!src/js/**/{test1,test2}.js'</span>])   
        .pipe(uglify({   
            <span class="hljs-comment">//mangle: true,//类型：Boolean 默认：true 是否修改变量名   </span>
            mangle: {<span class="hljs-attr">except</span>: [<span class="hljs-string">'require'</span> ,<span class="hljs-string">'exports'</span> ,<span class="hljs-string">'module'</span> ,<span class="hljs-string">'$'</span>]}<span class="hljs-comment">//排除混淆关键字   </span>
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    uglify= <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>);   

gulp.task(<span class="hljs-string">'jsmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src([<span class="hljs-string">'src/js/*.js'</span>, <span class="hljs-string">'!src/js/**/{test1,test2}.js'</span>])   
        .pipe(uglify({   
            <span class="hljs-attr">mangle</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//类型：Boolean 默认：true 是否修改变量名   </span>
            compress: <span class="hljs-literal">true</span>,<span class="hljs-comment">//类型：Boolean 默认：true 是否完全压缩   </span>
            preserveComments: all <span class="hljs-comment">//保留所有注释   </span>
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><h2><a name="gulp-autoprefixer插件说明" class="anchor" href="#gulp-autoprefixer插件说明"><span class="header-link"></span></a>gulp-autoprefixer插件说明</h2><p><a href="http://www.ydcss.com/archives/94">http://www.ydcss.com/archives/94</a><br>使用gulp-autoprefixer根据设置浏览器版本自动处理浏览器前缀。使用她我们可以很潇洒地写代码，不必考虑各浏览器兼容前缀。<br>【特别是开发移动端页面时，就能充分体现它的优势。例如兼容性不太好的flex布局。】<br>gulp-autoprefixer的browsers参数详解 （<a href="https://github.com/ai/browserslist#queries">传送门</a>）：<br>● last 2 versions: 主流浏览器的最新两个版本<br>● last 1 Chrome versions: 谷歌浏览器的最新版本<br>● last 2 Explorer versions: IE的最新两个版本<br>● last 3 Safari versions: 苹果浏览器最新三个版本<br>● Firefox &gt;= 20: 火狐浏览器的版本大于或等于20<br>● iOS 7: IOS7版本<br>● Firefox ESR: 最新ESR版本的火狐<br>● &gt; 5%: 全球统计有超过5%的使用率<br>3.3、发现上面规律了吗，相信这不难看出，接下来说说各浏览器的标识：   </p>
<ul>
<li>Android for Android WebView.   </li>
<li>BlackBerry or bb for Blackberry browser.   </li>
<li>Chrome for Google Chrome.   </li>
<li>Firefox or ff for Mozilla Firefox.   </li>
<li>Explorer or ie for Internet Explorer.   </li>
<li>iOS or ios_saf for iOS Safari.   </li>
<li>Opera for Opera.   </li>
<li>Safari for desktop Safari.   </li>
<li>OperaMobile or op_mob for Opera Mobile.   </li>
<li>OperaMini or op_mini for Opera Mini.   </li>
<li>ChromeAndroid or and_chr   </li>
<li>FirefoxAndroid or and_ff for Firefox for Android.   </li>
<li>ExplorerMobile or ie_mob for Internet Explorer Mobile.   </li>
</ul>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-autoprefixer'</span>);   

gulp.task(<span class="hljs-string">'testAutoFx'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/css/index.css'</span>)   
        .pipe(autoprefixer({   
            <span class="hljs-attr">browsers</span>: [<span class="hljs-string">'last 2 versions'</span>, <span class="hljs-string">'Android &gt;= 4.0'</span>],   
            <span class="hljs-attr">cascade</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//是否美化属性值 默认：true 像这样：   </span>
            <span class="hljs-comment">//-webkit-transform: rotate(45deg);   </span>
            <span class="hljs-comment">//        transform: rotate(45deg);   </span>
            remove:<span class="hljs-literal">true</span> <span class="hljs-comment">//是否去掉不必要的前缀 默认：true    </span>
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'dist/css'</span>));   
});</span>
</code></pre><h2><a name="gulp教程之gulp-minify-css插件说明" class="anchor" href="#gulp教程之gulp-minify-css插件说明"><span class="header-link"></span></a>gulp教程之gulp-minify-css插件说明</h2><p><a href="http://www.ydcss.com/archives/41">http://www.ydcss.com/archives/41</a><br>基本使用:   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    cssmin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-minify-css'</span>);   

gulp.task(<span class="hljs-string">'testCssmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/css/*.css'</span>)   
        .pipe(cssmin())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/css'</span>));   
});</span>
</code></pre><p>gulp-minify-css 最终是调用clean-css，其他参数查看<a href="https://github.com/jakubpawlowicz/clean-css#how-to-use-clean-css-api">这里</a>:   </p>
<pre><code>

<span class="python">var gulp = require(<span class="hljs-string">'gulp'</span>),   
    cssmin = require(<span class="hljs-string">'gulp-minify-css'</span>);   

gulp.task(<span class="hljs-string">'testCssmin'</span>, function () {   
    gulp.src(<span class="hljs-string">'src/css/*.css'</span>)   
        .pipe(cssmin({   
            advanced: false,//类型：Boolean 默认：true [是否开启高级优化（合并选择器等）]   
            compatibility: <span class="hljs-string">'ie7'</span>,//保留ie7及以下兼容写法 类型：String 默认：<span class="hljs-string">''</span>o<span class="hljs-string">r'*'</span> [启用兼容模式； <span class="hljs-string">'ie7'</span>：IE7兼容模式，<span class="hljs-string">'ie8'</span>：IE8兼容模式，<span class="hljs-string">'*'</span>：IE9+兼容模式]   
            keepBreaks: true//类型：Boolean 默认：false [是否保留换行]   
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'dist/css'</span>));   
});</span>
</code></pre><p><strong>给css文件里引用url加版本号（根据引用文件的md5生产版本号）,这样便可以清除上个版本的缓存影响</strong>，像这样：<br><img src="/data/dokuwiki/web/pasted/20160412-134510.png" alt="">   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    cssmin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-minify-css'</span>);   
    <span class="hljs-comment">//确保已本地安装gulp-make-css-url-version [cnpm install gulp-make-css-url-version --save-dev]   </span>
    cssver = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-make-css-url-version'</span>);    

gulp.task(<span class="hljs-string">'testCssmin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/css/*.css'</span>)   
        .pipe(cssver()) <span class="hljs-comment">//给css文件里引用文件加版本号（文件MD5）   </span>
        .pipe(cssmin())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/css'</span>));   
});</span>
</code></pre><h2><a name="gulp教程之gulp-imagemin" class="anchor" href="#gulp教程之gulp-imagemin"><span class="header-link"></span></a>gulp教程之gulp-imagemin</h2><p><a href="http://www.ydcss.com/archives/26">http://www.ydcss.com/archives/26</a><br><a href="https://github.com/sindresorhus/gulp-imagemin#user-content-options">https://github.com/sindresorhus/gulp-imagemin#user-content-options</a><br>使用gulp-imagemin压缩图片文件（包括PNG、JPEG、GIF和SVG图片）<br>基本使用：   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-imagemin'</span>);   

gulp.task(<span class="hljs-string">'testImagemin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/img/*.{png,jpg,gif,ico}'</span>)   
        .pipe(imagemin())   
        .pipe(gulp.dest(<span class="hljs-string">'dist/img'</span>));   
});</span>
</code></pre><pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-imagemin'</span>);   

gulp.task(<span class="hljs-string">'testImagemin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/img/*.{png,jpg,gif,ico}'</span>)   
        .pipe(imagemin({   
            <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span>, <span class="hljs-comment">//类型：Number  默认：3  取值范围：0-7（优化等级）   </span>
            progressive: <span class="hljs-literal">true</span>, <span class="hljs-comment">//类型：Boolean 默认：false 无损压缩jpg图片   </span>
            interlaced: <span class="hljs-literal">true</span>, <span class="hljs-comment">//类型：Boolean 默认：false 隔行扫描gif进行渲染   </span>
            multipass: <span class="hljs-literal">true</span> <span class="hljs-comment">//类型：Boolean 默认：false 多次优化svg直到完全优化   </span>
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'dist/img'</span>));   
});</span>
</code></pre><p><strong>只压缩修改的图片。压缩图片时比较耗时，在很多情况下我们只修改了某些图片，没有必要压缩所有图片，使用”gulp-cache”只压缩修改的图片，没有修改的图片直接从缓存文件读</strong>取（C:Users\Administrator\AppData\Local\Temp\gulp-cache）。   </p>
<pre><code>

<span class="php"><span class="hljs-keyword">var</span> gulp = <span class="hljs-keyword">require</span>(<span class="hljs-string">'gulp'</span>),   
    imagemin = <span class="hljs-keyword">require</span>(<span class="hljs-string">'gulp-imagemin'</span>),   
    pngquant = <span class="hljs-keyword">require</span>(<span class="hljs-string">'imagemin-pngquant'</span>),   
    <span class="hljs-comment">//确保本地已安装gulp-cache [cnpm install gulp-cache --save-dev]   </span>
    cache = <span class="hljs-keyword">require</span>(<span class="hljs-string">'gulp-cache'</span>);   

gulp.task(<span class="hljs-string">'testImagemin'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{   
    gulp.src(<span class="hljs-string">'src/img/*.{png,jpg,gif,ico}'</span>)   
        .pipe(cache(imagemin({   
            progressive: <span class="hljs-keyword">true</span>,   
            svgoPlugins: [{removeViewBox: <span class="hljs-keyword">false</span>}],   
            <span class="hljs-keyword">use</span>: [<span class="hljs-title">pngquant</span>()]   
        })))   
        .<span class="hljs-title">pipe</span>(<span class="hljs-title">gulp</span>.<span class="hljs-title">dest</span>('<span class="hljs-title">dist</span>/<span class="hljs-title">img</span>'));   
});</span>
</code></pre><h2><a name="gulp教程之gulp-concat合并文件" class="anchor" href="#gulp教程之gulp-concat合并文件"><span class="header-link"></span></a>gulp教程之gulp-concat合并文件</h2><p><a href="http://www.ydcss.com/archives/83">http://www.ydcss.com/archives/83</a>   </p>
<pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-concat'</span>);   

gulp.task(<span class="hljs-string">'testConcat'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{   
    gulp.src(<span class="hljs-string">'src/js/*.js'</span>)   
        .pipe(concat(<span class="hljs-string">'all.js'</span>))<span class="hljs-comment">//合并后的文件名   </span>
        .pipe(gulp.dest(<span class="hljs-string">'dist/js'</span>));   
});</span>
</code></pre><h2><a name="gulp-ruby-sass与ruby-gem配置" class="anchor" href="#gulp-ruby-sass与ruby-gem配置"><span class="header-link"></span></a>gulp-ruby-sass与ruby gem配置</h2><p><a href="https://github.com/sindresorhus/gulp-ruby-sass">https://github.com/sindresorhus/gulp-ruby-sass</a><br><a href="http://www.zuojj.com/archives/550.html?utm_source=tuicool&amp;utm_medium=referral">http://www.zuojj.com/archives/550.html?utm_source=tuicool&amp;utm_medium=referral</a><br>首先得安装sass程序，不然会报错。而安装sass之前得安装ruby，这样才能通过gem安装sass。<br>Ruby安装:<a href="http://rubyinstaller.org/downloads/">http://rubyinstaller.org/downloads/</a><br>然后通过gem install sass<br>检测是否正确:sass -v<br>不过貌似gem中央仓库被墙了。所以需要使用淘宝镜像。<br><strong>gem国内镜像配置</strong><br>gem淘宝源<a href="http://ruby.taobao.org/以及不再更新了。请看http://www.oschina.net/news/71749/taobao-gems-ruby-china">http://ruby.taobao.org/以及不再更新了。请看http://www.oschina.net/news/71749/taobao-gems-ruby-china</a><br>推荐使用<a href="https://gems.ruby-china.org/源">https://gems.ruby-china.org/源</a>   </p>
<pre><code>

<span class="shell"><span class="hljs-meta">$</span><span class="bash"> gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/   </span>
<span class="hljs-meta">$</span><span class="bash"> gem sources -l   </span>
*** CURRENT SOURCES ***   

https://gems.ruby-china.org   
<span class="hljs-meta">#</span><span class="bash"> 确保只有 gems.ruby-china.org   </span>
<span class="hljs-meta">$</span><span class="bash"> gem install sass</span></span>
</code></pre><p>如果遇到 SSL 证书问题，你又无法解决，请直接用 <a href="http://gems.ruby-china.org">http://gems.ruby-china.org</a> 避免 SSL 的问题。   </p>
<pre><code>

<span class="javascript">gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>);   
sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-ruby-sass'</span>);   
sourcemaps = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-sourcemaps'</span>);   

gulp.task(<span class="hljs-string">'sass'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
    sass(<span class="hljs-string">'source/file.scss'</span>, {<span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>})   
        .on(<span class="hljs-string">'error'</span>, sass.logError)   
        <span class="hljs-comment">// for inline sourcemaps   </span>
        .pipe(sourcemaps.write())   
        <span class="hljs-comment">// for file sourcemaps   </span>
        .pipe(sourcemaps.write(<span class="hljs-string">'maps'</span>, {   
            <span class="hljs-attr">includeContent</span>: <span class="hljs-literal">false</span>,   
            <span class="hljs-attr">sourceRoot</span>: <span class="hljs-string">'source'</span>   
        }))   
        .pipe(gulp.dest(<span class="hljs-string">'result'</span>))   
});</span>
</code></pre><h2><a name="使用示例" class="anchor" href="#使用示例"><span class="header-link"></span></a>使用示例</h2><pre><code>

<span class="javascript"><span class="hljs-keyword">var</span> gulp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp'</span>),   
    sass = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-ruby-sass'</span>),   
    autoprefixer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-autoprefixer'</span>),   
    minifycss = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-minify-css'</span>),   
    jshint = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-jshint'</span>),   
    uglify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-uglify'</span>),   
    imagemin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-imagemin'</span>),   
    rename = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-rename'</span>),   
    concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-concat'</span>),   
    notify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-notify'</span>),   
    cache = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-cache'</span>),   
    livereload = <span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-livereload'</span>),   
    del = <span class="hljs-built_in">require</span>(<span class="hljs-string">'del'</span>),   
    cssver=<span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-make-css-url-version'</span>),   
    sourcemaps=<span class="hljs-built_in">require</span>(<span class="hljs-string">'gulp-sourcemaps'</span>);   
  gulp.task(<span class="hljs-string">'testJs'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      <span class="hljs-keyword">return</span> gulp.src([<span class="hljs-string">'common/**/*.js'</span>,<span class="hljs-string">'!**/block.js'</span>])   
              .pipe(sourcemaps.init())   
              .pipe(rename({<span class="hljs-attr">suffix</span>:<span class="hljs-string">'.min'</span>}))   
              .pipe(uglify({   
                  <span class="hljs-attr">mangle</span>:<span class="hljs-literal">false</span>   
              }))   
              .pipe(concat(<span class="hljs-string">'all.js'</span>))   
              .pipe(sourcemaps.write())   
              .pipe(gulp.dest(<span class="hljs-string">'dest/js'</span>));   
  });   
  gulp.task(<span class="hljs-string">'testSass'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      <span class="hljs-keyword">return</span> sass(<span class="hljs-string">'common/*.scss'</span>, {})   
          .pipe(gulp.dest(<span class="hljs-string">'dest'</span>));   
  });   
  gulp.task(<span class="hljs-string">'testCss'</span>,[<span class="hljs-string">'testSass'</span>],<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      <span class="hljs-keyword">return</span> gulp.src([<span class="hljs-string">'common/**/*.css'</span>])   
              .pipe(autoprefixer(<span class="hljs-string">'last 2 version'</span>, <span class="hljs-string">'safari 5'</span>, <span class="hljs-string">'ie 8'</span>, <span class="hljs-string">'ie 9'</span>, <span class="hljs-string">'opera 12.1'</span>, <span class="hljs-string">'ios 6'</span>, <span class="hljs-string">'android 4'</span>))   
              .pipe(gulp.dest(<span class="hljs-string">'dist/prefix'</span>))   
            .pipe(cssver())   
              .pipe(minifycss({   
                  <span class="hljs-attr">compatibility</span>:<span class="hljs-string">'ie8'</span>   
              }))   
              .pipe(rename({<span class="hljs-attr">suffix</span>:<span class="hljs-string">'.min'</span>}))   
              .pipe(gulp.dest(<span class="hljs-string">'dest/css'</span>));   
  });   
  gulp.task(<span class="hljs-string">'testHtml'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      <span class="hljs-keyword">return</span> gulp.src([<span class="hljs-string">'common/index.html'</span>])   
              .pipe(cssver())   
              .pipe(gulp.dest(<span class="hljs-string">'dest/html'</span>));   
  });   
  gulp.task(<span class="hljs-string">'testImg'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      <span class="hljs-keyword">return</span> gulp.src([<span class="hljs-string">'common/**/*.{png,jpg,ico,gif}'</span>])   
              .pipe(cache(imagemin()))   
              .pipe(gulp.dest(<span class="hljs-string">'dest/image'</span>));         
  });   
  gulp.task(<span class="hljs-string">'clean'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">callback</span>)</span>{   
      <span class="hljs-keyword">return</span> del([<span class="hljs-string">'dest/js'</span>,<span class="hljs-string">'dest/css'</span>,<span class="hljs-string">'dest/html'</span>,<span class="hljs-string">'dest/image'</span>],callback);   

  });   
  gulp.task(<span class="hljs-string">'default'</span>,[<span class="hljs-string">'clean'</span>],<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      gulp.start(<span class="hljs-string">'testJs'</span>,<span class="hljs-string">'testCss'</span>,<span class="hljs-string">'testHtml'</span>);   
  });   

  gulp.task(<span class="hljs-string">'watch'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{   
      gulp.watch(<span class="hljs-string">'common/*.scss'</span>,[<span class="hljs-string">'testSass'</span>]);   
  });</span>
</code></pre>
            </div>
			<footer><p>powered by xbynet</p></footer>
        </div>
    </div>
	
    <a href="#" id="back-to-top" title="Back to top">返回顶部</a>
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            hljs.initHighlightingOnLoad();
            $("li>code,p > code").addClass("code");
            $('#sidebarCollapse').on('click', function() {
                $('#sidebar').toggleClass('active');
            });
        });
        if ($('#back-to-top').length) {
            var scrollTrigger = 100, // px
                backToTop = function() {
                    var scrollTop = $(window).scrollTop();
                    if (scrollTop > scrollTrigger) {
                        $('#back-to-top').addClass('show');
                    } else {
                        $('#back-to-top').removeClass('show');
                    }
                };
            backToTop();
            $(window).on('scroll', function() {
                backToTop();
            });
            $('#back-to-top').on('click', function(e) {
                e.preventDefault();
                $('html,body').animate({
                    scrollTop: 0
                }, 700);
            });
        }
    </script>
</body>

</html>